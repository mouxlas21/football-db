<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Competitions — Football Database</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link href="/static/css/main.css" rel="stylesheet"/>
  <style>
    details.block { border: 1px solid #eee; border-radius: 8px; margin:.65rem 0; }
    details.block summary { list-style:none; cursor:pointer; padding:.6rem .8rem; display:flex; align-items:center; gap:.5rem; }
    details.block summary::-webkit-details-marker { display:none; }
    details.block[open]{ border-color:#ddd; box-shadow:0 0 0 3px rgba(0,0,0,.02) inset;}
    .muted{color:#666;font-size:.9em;}
    .chev{margin-left:auto;transition:transform .15s ease;}
    details[open] .chev{transform:rotate(90deg);}
    .grid{display:grid;gap:.75rem;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));}
    .card-item{border:1px solid #eee;border-radius:10px;background:#fff;padding:.6rem;display:block;color:inherit;text-decoration:none;}
    .thumb{height:100px;display:flex;align-items:center;justify-content:center;background:#fafafa;border:1px dashed #eee;border-radius:8px;margin-bottom:.5rem;}
    .thumb img{max-height:100%;max-width:100%;object-fit:contain;}
    .chips{display:flex;flex-wrap:wrap;gap:.3rem;margin:.3rem 0 .2rem 0;}
    .chip{border:1px solid #eee;border-radius:999px;padding:.1rem .45rem;font-size:.78rem;}
    .chip.muted{opacity:.7;}
  </style>
</head>
<body>
  <header class="container">
    <h1>Competitions</h1>
  </header>

  <main class="container" style="margin-top:1rem">
    {% if federations|length == 0 %}
      <p>No competitions.</p>
    {% else %}
      {% for fed in federations %}
        <details class="block">
          <summary>
            {% if fed.logo %}
              <img src="{{ fed.logo }}" alt="{{ fed.code }} logo" style="height:18px;vertical-align:middle;" onerror="this.style.display='none'">
            {% endif %}
            <strong>{{ fed.code }}</strong>
            <span class="muted">({{ (fed.international|length)+(fed.domestic|length) }})</span>
            <span class="chev">›</span>
          </summary>

          <div style="padding:.5rem .9rem 1rem .9rem;">

            <!-- International -->
            <details class="block">
              <summary>
                <strong>International</strong>
                <span class="muted">({{ fed.international|length }})</span>
                <span class="chev">›</span>
              </summary>
              <div style="padding:.4rem .9rem .9rem;">
                {% if fed.international|length == 0 %}
                  <p class="muted">No international competitions.</p>
                {% else %}
                  <div class="grid">
                    {% for c in fed.international %}
                      <a class="card-item" href="/competitions/{{ c.id }}">
                        <div class="thumb">
                          {% if c.filename and c.image_base %}
                            <img src="{{ BASE_COMP_IMG }}/{{ c.image_base }}/thumbs/{{ c.filename }}"
                                 alt="{{ c.name }}"
                                 onerror="this.onerror=null;this.src='{{ BASE_COMP_IMG }}/{{ c.image_base }}/{{ c.filename }}'">
                          {% else %}<div class="muted">No image</div>{% endif %}
                        </div>
                        <div style="font-weight:600">{{ c.name }}</div>
                        <div class="chips">
                          {% if c.gender %}<span class="chip">{{ c.gender }}</span>{% endif %}
                          {% if c.age_group %}<span class="chip">{{ c.age_group }}</span>{% endif %}
                          {% if c.type %}<span class="chip">{{ c.type }}</span>{% endif %}
                          {% if c.tier %}<span class="chip">Tier {{ c.tier }}</span>{% endif %}
                          {% if c.cup_rank %}<span class="chip">{{ c.cup_rank }}</span>{% endif %}
                        </div>
                      </a>
                    {% endfor %}
                  </div>
                {% endif %}
              </div>
            </details>

            <!-- Domestic -->
            <details class="block" style="margin-top:.6rem;">
              <summary>
                <strong>Domestic</strong>
                <span class="muted">({{ fed.domestic|length }} countries)</span>
                <span class="chev">›</span>
              </summary>
              <div style="padding:.4rem .9rem .9rem;">
                {% if fed.domestic|length == 0 %}
                  <p class="muted">No domestic competitions.</p>
                {% else %}
                  {% for grp in fed.domestic %}
                    <details class="block">
                      <summary>
                        {% if grp.country.flag %}
                          <img src="{{ grp.country.flag }}" alt="{{ grp.country.name }} flag" style="height:18px;vertical-align:middle;" onerror="this.style.display='none'">
                        {% endif %}
                        <strong>{{ grp.country.name }}</strong>
                        <span class="muted">({{ grp['items']|length }})</span>
                        <span class="chev">›</span>
                      </summary>
                      <div style="padding:.4rem .9rem .9rem;">
                        <div class="grid">
                          {% for c in grp['items'] %}
                            <a class="card-item" href="/competitions/{{ c.id }}">
                              <div class="thumb">
                                {% if c.filename and c.image_base %}
                                  <img src="{{ BASE_COMP_IMG }}/{{ c.image_base }}/thumbs/{{ c.filename }}"
                                       alt="{{ c.name }}"
                                       onerror="this.onerror=null;this.src='{{ BASE_COMP_IMG }}/{{ c.image_base }}/{{ c.filename }}'">
                                {% else %}<div class="muted">No image</div>{% endif %}
                              </div>
                              <div style="font-weight:600">{{ c.name }}</div>
                              <div class="chips">
                                {% if c.gender %}<span class="chip">{{ c.gender }}</span>{% endif %}
                                {% if c.age_group %}<span class="chip">{{ c.age_group }}</span>{% endif %}
                                {% if c.type %}<span class="chip">{{ c.type }}</span>{% endif %}
                                {% if c.tier %}<span class="chip">Tier {{ c.tier }}</span>{% endif %}
                                {% if c.cup_rank %}<span class="chip">{{ c.cup_rank }}</span>{% endif %}
                              </div>
                            </a>
                          {% endfor %}
                        </div>
                      </div>
                    </details>
                  {% endfor %}
                {% endif %}
              </div>
            </details>

          </div>
        </details>
      {% endfor %}
    {% endif %}
  </main>
</body>
</html>
